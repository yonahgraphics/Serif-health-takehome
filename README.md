# Serif Health Takehome Interview Solution
![Alt text](data:image/png;base64,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)

## Overview

This repository contains solutions for the Serif Health Takehome Engineering Interview, focusing on extracting and processing healthcare pricing data. Key components include a Python script (`parse_anthem_ppo_urls.py`), a Bash script (`run_python_script.sh`) for execution, and a Jupyter Notebook (`explore_anthem_data.ipynb`) for preliminary data exploration.

## Input Data Source

- The data should be downloaded from the following URL and placed in the same directory as the scripts:
  [Data Link](https://antm-pt-prod-dataz-nogbd-nophi-us-east1.s3.amazonaws.com/anthem/2024-01-01_anthem_index.json.gz)

## Components and Rationale

1. **`parse_anthem_ppo_urls.py`**:
   - A Python script that processes a large JSON file to extract machine-readable file URLs for Anthem's PPO network in New York state.
   - Python is chosen for its robustness and widespread use in data processing and analysis.

2. **`run_python_script.sh`**:
   - A bash script that creates a virtual environment, activates it, installs dependencies, and runs `parse_anthem_ppo_urls.py`.
   - This script ensures that the Python script runs in a controlled environment with all required dependencies, avoiding version conflicts and enhancing portability.

3. **`explore_anthem_data.ipynb`**:
   - A Jupyter Notebook used for initial data exploration.
   - Facilitates understanding of the dataset by showing the schema, data types, and record count.
   - Justifies the necessity of exploring the data to inform effective and efficient script development.
   - Can be opened and run in an IPython Notebook environment.

## Choice of PySpark

- **Handling Large Data**: PySpark is specifically chosen for its ability to handle and process large datasets efficiently.
- **Scalability and Performance**: PySpark's distributed computing capabilities make it ideal for tasks that involve large volumes of data, ensuring scalability and high performance.
- **Ease of Integration**: PySpark seamlessly integrates with the Python ecosystem, allowing for the utilization of Python's libraries and tools alongside Spark's powerful data processing framework.

## Python and PySpark Versions

- Developed using Python 3.10.13; compatible with Python versions >= 3.8.0.
- Utilizes PySpark version 3.5.0.
- Compatibility between Python and PySpark versions is crucial for avoiding issues and ensuring seamless functionality.

## Execution Time

- The script `parse_anthem_ppo_urls.py` completed execution in approximately 5.3 minutes on a MacBook Pro.

## Setup and Execution Instructions

- Ensure Python (version >= 3.8.0) and pip are installed.
- Download the data from the provided URL and place it along in one level above the `scripts` directory.
- In your terminal, navigate to the directory containing the scripts and:
   - Make the bash script executable using chmod +x run_python_script.sh
   - Execute the bash script using `./run_python_script.sh`.
- For data exploration, open `explore_anthem_data.ipynb` in an IPython Notebook environment.

## Output

The output is a folder called `anthem_ppo_urls.csv` containing a csv file with distinct URLs for Anthem's PPO network in New York state.

## Additional Notes

- The modular approach with separate script and notebook files promotes clarity and maintainability.
- The virtual environment ensures a controlled execution environment, maintaining dependency consistency.

## Development Time

- The entire solution, including writing the README file and organizing the different scripts and files, took approximately 3.5 hours to develop.

## Solution Runtime

- The `parse_anthem_ppo_urls.py` script has an execution time of approximately 322.9318540096283 seconds (about 5.4 minutes).

## Tradeoffs and Further Considerations

- **Use of PySpark**: While PySpark provides excellent scalability and performance for handling large datasets, it introduces complexity in setup and execution, especially when compared to simpler Python-based solutions.
- **Cloud-Based Execution**: Ideally, for optimal performance and handling even larger datasets, this solution should be run on a cloud-based cluster. Running PySpark on a local machine may not fully leverage its distributed computing capabilities.
- **Cost-Benefit Analysis**: The decision to use PySpark should be weighed against the actual size and complexity of the data. For smaller datasets, simpler and less resource-intensive tools might be more appropriate.
- **Future Enhancements**: Consideration for future enhancements includes implementing logging, and perhaps a more interactive data exploration tool, enhancing the usability for non-technical stakeholders.
- **Portability and Compatibility**: Ensuring compatibility with various operating systems and Python versions is crucial for widespread use. The use of a virtual environment aids in this, but further testing and adjustments may be necessary for different environments.
